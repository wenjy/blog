<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Linux 常用命令 | 江湖义气的博客</title><meta property="og:title" content="Linux 常用命令 - 江湖义气的博客"><meta property="og:type" content="article"><meta property="article:published_time" content="2020-03-26T22:53:12+08:00"><meta property="article:modified_time" content="2020-03-26T22:53:12+08:00"><meta name=Keywords content="[Linux 常用命令]"><meta name=description content="Linux 常用命令"><meta name=author content="江湖义气"><meta property="og:url" content="https://blog.wenjy.top/2020/03/26/linux-command.html"><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=stylesheet href=/css/normalize.css><link rel=stylesheet href=/css/style.css><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><a id=logo href=https://blog.wenjy.top>江湖义气的博客</a><p class=description>专注PHP开发。愿回首往事，不会因为虚度年华而悔恨，也不会因为碌碌无为而感到羞愧。</p></div><div><nav id=nav-menu class=clearfix><a class=current href=https://blog.wenjy.top>首页</a>
<a href=https://blog.wenjy.top/tools/ title=工具>工具</a>
<a href=https://blog.wenjy.top/archives/ title=归档>归档</a>
<a href=https://blog.wenjy.top/about/ title=关于>关于</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><style type=text/css>.post-toc{position:fixed;width:200px;margin-left:-210px;padding:5px 10px;font-family:Athelas,STHeiti,Microsoft Yahei,serif;font-size:12px;border:1px solid rgba(0,0,0,.07);border-radius:5px;background-color:rgba(255,255,255,.98);background-clip:padding-box;-webkit-box-shadow:1px 1px 2px rgba(0,0,0,.125);box-shadow:1px 1px 2px rgba(0,0,0,.125);word-wrap:break-word;white-space:nowrap;-webkit-box-sizing:border-box;box-sizing:border-box;z-index:999;cursor:pointer;max-height:70%;overflow-y:auto;overflow-x:hidden}.post-toc .post-toc-title{width:100%;margin:0 auto;font-size:20px;font-weight:400;text-transform:uppercase;text-align:center}.post-toc .post-toc-content{font-size:15px}.post-toc .post-toc-content>nav>ul{margin:10px 0}.post-toc .post-toc-content ul{padding-left:20px;list-style:square;margin:.5em;line-height:1.8em}.post-toc .post-toc-content ul ul{padding-left:15px;display:none}@media print,screen and (max-width:1057px){.post-toc{display:none}}</style><div class=post-toc style=position:absolute;top:188px><h2 class=post-toc-title>文章目录</h2><div class=post-toc-content><nav id=TableOfContents><ul><li><a href=#ls>ls</a></li><li><a href=#cd>cd</a></li><li><a href=#pwd>pwd</a></li><li><a href=#rm>rm</a></li><li><a href=#rmdir>rmdir</a></li><li><a href=#mv>mv</a></li><li><a href=#cp>cp</a></li><li><a href=#cat>cat</a></li><li><a href=#less>less</a></li><li><a href=#head>head</a></li><li><a href=#tail>tail</a></li><li><a href=#which>which</a></li><li><a href=#whereis>whereis</a></li><li><a href=#locate>locate</a></li><li><a href=#find>find</a></li><li><a href=#chomd>chomd</a></li><li><a href=#tar>tar</a></li><li><a href=#chown>chown</a></li><li><a href=#df>df</a></li><li><a href=#du>du</a></li><li><a href=#ln>ln</a></li><li><a href=#diff>diff</a></li><li><a href=#date>date</a></li><li><a href=#grep>grep</a></li><li><a href=#wc>wc</a></li><li><a href=#ps>ps</a></li><li><a href=#kill>kill</a></li><li><a href=#killall>killall</a></li><li><a href=#pkill>pkill</a></li><li><a href=#top>top</a></li><li><a href=#uptime>uptime</a></li><li><a href=#free>free</a></li><li><a href=#vmstat>vmstat</a></li><li><a href=#watch>watch</a></li><li><a href=#crontab>crontab</a></li><li><a href=#ifconfig>ifconfig</a></li><li><a href=#route>route</a></li><li><a href=#ping>ping</a></li><li><a href=#traceroute>traceroute</a></li><li><a href=#netstat>netstat</a></li><li><a href=#ss>ss</a></li><li><a href=#telnet>telnet</a></li><li><a href=#rcp>rcp</a></li><li><a href=#scp>scp</a></li><li><a href=#wget>wget</a></li><li><a href=#tcpdump>tcpdump</a></li><li><a href=#strace>strace</a></li><li><a href=#gdb>gdb</a></li><li><a href=#lsof>lsof</a></li><li><a href=#pref>pref</a></li><li><a href=#awk>awk</a></li><li><a href=#groups>groups</a></li><li><a href=#useradd>useradd</a></li><li><a href=#passwd>passwd</a></li><li><a href=#su>su</a></li><li><a href=#sudo>sudo</a></li><li><a href=#curl>curl</a></li><li><a href=#ssh>ssh</a><ul><li><a href=#用来传输数据>用来传输数据</a></li><li><a href=#绑定本地端口>绑定本地端口</a></li><li><a href=#本地端口转发>本地端口转发</a></li><li><a href=#远程端口转发>远程端口转发</a></li></ul></li><li><a href=#netcat>netcat</a></li><li><a href=#time>time</a></li></ul></nav></div></div><script type=text/javascript>$(document).ready(function(){var postToc=$(".post-toc");if(postToc.length){var leftPos=$("#main").offset().left;if(leftPos<220){postToc.css({"width":leftPos-10,"margin-left":(0-leftPos)})}
var t=postToc.offset().top-20,a={start:{position:"absolute",top:t},process:{position:"fixed",top:20},};$(window).scroll(function(){var e=$(window).scrollTop();e<t?postToc.css(a.start):postToc.css(a.process)})}})</script><article class=post><header><h1 class=post-title>Linux 常用命令</h1></header><date class="post-meta meta-date">2020年3月26日</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=https://blog.wenjy.top/categories/Linux>Linux</a></span></div><div class=post-meta><span id=busuanzi_container_page_pv>|<span id=busuanzi_value_page_pv></span><span>
阅读</span></span></div><div class=post-content><h2 id=ls>ls</h2><p><code>ls -alh</code></p><pre><code>-a, -all 列出目录下的所有文件，包括以 . 开头的隐含文件
-l 除了文件名之外，还将文件的权限、所有者、文件大小等信息详细列出来
-h, –human-readable 以容易理解的格式列出文件大小 (例如 1K 234M 2G)
</code></pre><h2 id=cd>cd</h2><p><code>cd /usr/local</code> 使用绝对路径</p><p><code>cd ../</code> 使用相对路径</p><p><code>cd ~</code> home目录</p><p><code>cd -</code> 返回进入此目录之前所在的目录</p><h2 id=pwd>pwd</h2><p>查看“当前工作目录”的完整路径</p><p><code>pwd -P</code> 显示出实际路径，而非使用连接（link）路径</p><p><code>pwd -L</code> 目录连接链接时，输出连接路径</p><h2 id=rm>rm</h2><p>删除一个目录中的一个或多个文件或目录，它也可以将某个目录及其下的所有文件及子目录均删除。
对于链接文件，只是删除了链接，原有文件均保持不变。</p><p><code>rm -rf /a/b/c</code> 我是谁，我在哪里，我做了什么？</p><p><code>rm -i /a/b/*.log</code> 可以使用通配符</p><pre><code>-f, --force 忽略不存在的文件，从不给出提示。
-i, --interactive 进行交互式删除
-r, -R, --recursive 指示rm将参数中列出的全部目录和子目录均递归地删除。
</code></pre><h2 id=rmdir>rmdir</h2><p>删除空目录，一个目录被删除之前必须是空的。</p><h2 id=mv>mv</h2><p>mv命令是move的缩写，可以用来移动文件或者将文件改名。</p><p><code>mv test.log test1.txt</code> 把test.log重命名为test1.txt</p><h2 id=cp>cp</h2><p>复制文件或者目录</p><p><code>cp log1 log.bak</code> 复制log1为log.bak</p><h2 id=cat>cat</h2><p>显示文件内容，或者将几个文件连接起来显示，或者从标准输入读取内容并显示，它常与重定向符号配合使用。</p><p><code>cat filename</code> 显示filename的内容</p><p><code>cat filename1 fielname2 > filename3</code> 把filename1和2合并为filename3，只能创建新文件,不能编辑已有文件</p><h2 id=less>less</h2><p>文件或其它输出进行分页显示，文件比较大时less不是加载整个文件</p><h2 id=head>head</h2><p>显示开头</p><p><code>head -n 10 filename</code> 显示前10行</p><h2 id=tail>tail</h2><p>显示结尾</p><p><code>tail -n 10 -f filename</code> 循环显示结尾10行，调试监控某日志文件时经常使用</p><h2 id=which>which</h2><p>查看可执行文件的位置。
在PATH变量指定的路径中，搜索某个系统命令的位置，并且返回第一个搜索结果。</p><h2 id=whereis>whereis</h2><p>查看文件的位置。定位可执行文件、源代码文件、帮助文件在文件系统中的位置。</p><h2 id=locate>locate</h2><p>配合数据库查看文件位置。loacte时直接找该索引，查询速度会较快，索引数据库一般是由操作系统管理</p><h2 id=find>find</h2><p>实际搜寻硬盘查询文件名称。</p><p><code>find . -type f -exec ls -l {} \;</code> ls -l命令放在find命令的-exec选项中</p><p><code>find . -type f -print | xargs file</code> 查找系统中的每一个普通文件，然后使用xargs命令来测试它们分别属于哪类文件</p><p><code>find . -name "*.log" -print</code> 在当前目录及子目录中查找所有的‘*.log’文件</p><h2 id=chomd>chomd</h2><p>改变linux系统文件或目录的访问权限。</p><p><code>chomd -R 0644 /test</code> 递归修改目录权限</p><p><code>chomd +x /test/test.sh</code> 增加执行权限</p><h2 id=tar>tar</h2><p>压缩，解压缩，打包，解包等</p><p><code>tar xvf FileName.tar</code> 解包</p><p><code>tar cvf FileName.tar DirName</code> 打包</p><p><code>tar zxvf FileName.tar.gz</code> 解压</p><p><code>tar zcvf FileName.tar.gz DirName</code> 压缩</p><p><code>tar jxvf FileName.tar.bz2</code> 解压</p><p><code>tar jcvf FileName.tar.bz2 DirName</code> 压缩</p><h2 id=chown>chown</h2><p>将指定文件的拥有者改为指定的用户或组，用户可以是用户名或者用户ID；组可以是组名或者组ID；
文件是以空格分开的要改变权限的文件列表，支持通配符</p><p><code>chown mail:mail -R /test</code> 递归把<code>/test</code> 目录的用户和用户组改成mail</p><h2 id=df>df</h2><p>检查linux服务器的文件系统的磁盘空间占用情况。</p><p><code>df -h</code> 方便阅读方式显示</p><h2 id=du>du</h2><p>文件和目录磁盘使用的空间的查看</p><p><code>du -h --max-depth=1</code> 输出当前目录下各个子目录所使用的空间</p><h2 id=ln>ln</h2><p>为某一个文件在另外一个位置建立一个同步的链接.当我们需要在不同的目录，用到相同的文件时，
我们不需要在每一个需要的目录下都放一个必须相同的文件，我们只要在某个固定的目录，放上该文件，
然后在 其它的目录下用ln命令链接（link）它就可以，不必重复的占用磁盘空间</p><p><code>ln -s log2013.log link2013</code> 给文件log2013.log创建软链接</p><h2 id=diff>diff</h2><p>用于比较文件的内容，特别是比较两个版本不同的文件以找到改动的地方</p><p><code>diff log2014.log log2013.log</code></p><h2 id=date>date</h2><p>可以用来显示或设定系统的日期与时间</p><p><code>date '+%Y-%m-%d %T'</code> 2020-03-26 15:26:08</p><h2 id=grep>grep</h2><p>(Global Regular Expression Print)使用正则表达式搜索文本，并把匹 配的行打印出来。</p><p><code>ll /usr/local/bin |grep php</code></p><h2 id=wc>wc</h2><p>(Word Count)统计指定文件中的字节数、字数、行数，并将统计结果显示输出</p><p><code>ps aux|grep php-fpm|wc -l</code> 统计php-fpm的进程数</p><h2 id=ps>ps</h2><p><code>ps aux|grep php-fpm</code></p><p>解释：</p><p>USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND</p><p>USER 进程用户</p><p>PID 进程ID</p><p>%CPU 进程占用的CPU百分比</p><p>%MEM 占用内存的百分比</p><p>VSZ 进程使用的虚拟内存量（KB）</p><p>RSS 进程占用的固定内存量（KB）</p><p>TTY 该进程在哪个终端上运行（登陆者的终端位置），若与终端无关，则显示（？）。若为pts/0等，则表示由网络连接主机进程</p><p>STAT 当前状态（D 无法中断的休眠状态、R 正在运行、S 处于休眠、T 停止或被追踪、Z 僵尸进程、&lt; 优先级高、N 优先级较低、s 进程的领导者、l 多进程、+ 位于后台的进程组）</p><p>START 进程被触发启动时间</p><p>TIME 进程实际使用CPU运行的时间</p><p>COMMAND 命令的名称和参数
`</p><p><code>ps -ef|grep php-fpm</code></p><h2 id=kill>kill</h2><p>用来终止指定的进程</p><p><code>kill -9 12345</code> 强制杀死进程</p><p><code>kill -15 12345</code> 终止指定进程</p><h2 id=killall>killall</h2><p>用于杀死指定名字的进程（kill processes by name）</p><p><code>killall php-fpm</code></p><h2 id=pkill>pkill</h2><p>pkill和killall应用方法差不多，也是直接杀死运行中的程序；如果想杀掉单个进程，请用kill来杀掉。</p><p><code>软件能用自己提供的命令来终止，重启最好</code></p><h2 id=top>top</h2><p>实时显示系统中各个进程的资源占用状况</p><h2 id=uptime>uptime</h2><p>top中运行时间，负载值</p><h2 id=free>free</h2><p>显示Linux系统中空闲的、已用的物理内存及swap内存,及被内核使用的buffer</p><p><code>free -m</code></p><h2 id=vmstat>vmstat</h2><p>Virtual Meomory Statistics（虚拟内存统计）的缩写，可对操作系统的虚拟内存、进程、CPU活动进行监控</p><h2 id=watch>watch</h2><p>watch可以帮你监测一个命令的运行结果，省得你一遍遍的手动运行。在Linux下，watch是周期性的执行下个程序，并全屏显示执行结果</p><p><code>watch -n 1 -d netstat -ant</code> 每隔一秒高亮显示网络链接数的变化情况</p><h2 id=crontab>crontab</h2><p><code>crontab -u www -l</code> 查看</p><p><code>crontab -e</code> 编辑</p><h2 id=ifconfig>ifconfig</h2><p>命令用来查看和配置网络设备。当网络环境发生改变时可通过此命令对网络进行相应的配置</p><p><code>ifconfig eth0 up</code> 启动网卡</p><p><code>ifconfig eth0 down</code> 关闭网卡</p><h2 id=route>route</h2><p>用于显示和操作IP路由表（show / manipulate the IP routing table）</p><h2 id=ping>ping</h2><p>测试与目标主机的连通性</p><p><code>ping www.baidu.com</code></p><p><code>ping 112.112.112.112</code></p><h2 id=traceroute>traceroute</h2><p>通过发送小的数据包到目的设备直到其返回，来测量其需要多长时间。一条路径上的每个设备traceroute要测3次。
输出结果中包括每次测试的时间(ms)和设备的名称（如有的话）及其IP地址。</p><p><code>traceroute www.baidu.com</code></p><h2 id=netstat>netstat</h2><p>显示与IP、TCP、UDP和ICMP协议相关的统计数据，一般用于检验本机各端口的网络连接情况。
netstat是在内核中访问网络及相关信息的程序，它能提供TCP连接，TCP和UDP监听，进程内存管理的相关报告。</p><p><code>netstat -anlp |grep :9999</code></p><p><code>netstat -s</code> 统计各网络信息</p><h2 id=ss>ss</h2><p>Socket Statistics的缩写。顾名思义，ss命令可以用来获取socket统计信息，它可以显示和netstat类似的内容。
但ss的优势在于它能够显示更多更详细的有关TCP和连接状态的信息，而且比netstat更快速更高效。</p><p><code>ss -anlp|grep :9999</code></p><h2 id=telnet>telnet</h2><p>用来远程登录</p><p><code>telnet 127.0.0.1 9999</code></p><h2 id=rcp>rcp</h2><p>用于在计算机之间拷贝文件。rcp命令有两种格式。第一种格式用于文件到文件的拷贝；第二种格式用于把文件或目录拷贝到另一个目录中。</p><p><code>rcp test1 webserver1:/home/root/test3</code> 将当前目录下的 test1 复制到名为 webserver1的远程系统</p><h2 id=scp>scp</h2><p>secure copy的简写，用于在Linux下进行远程拷贝文件的命令，和它类似的命令有cp，不过cp只是在本机进行拷贝不能跨服务器，而且scp传输是加密的。</p><p><code>scp local_file remote_username@remote_ip:remote_folder</code> 从本地服务器复制到远程服务器</p><p><code>scp root@192.168.120.204:/opt/soft/nginx-0.5.38.tar.gz /opt/soft/</code> 从远程服务器复制到本地服务器</p><h2 id=wget>wget</h2><p>一个下载文件的工具，它用在命令行下</p><p><code>wget http://www.minjieren.com/wordpress-3.1-zh_CN.zip</code> 下载单个文件</p><p><code>wget -O wordpress.zip http://www.minjieren.com/download.aspx?id=1080</code> 使用wget -O下载并以不同的文件名保存</p><p><code>wget -c http://www.minjieren.com/wordpress-3.1-zh_CN.zip</code> 使用wget -c断点续传</p><p><code>wget -c http://www.minjieren.com/wordpress-3.1-zh_CN.zip</code> 使用wget -b后台下载</p><h2 id=tcpdump>tcpdump</h2><p>在调试网络通信程序是 tcpdump 是必备工具。tcpdump 很强大，可以看到网络通信的每个细节。
如 TCP，可以看到 3 次握手，PUSH/ACK 数据推送，close4 次挥手，全部细节。包括每一次网络收包的字节数，时间等。</p><p><code>tcpdump -i lo -Xnlps0 tcp port 9999</code> 抓lo网卡，tcp协议，端口9999 通信的数据内容</p><h2 id=strace>strace</h2><p>可以跟踪系统调用的执行情况，在程序发生问题后，可以用 strace 分析和跟踪问题。</p><p><code>strace -o /tmp/strace.log -f -p $PID</code></p><h2 id=gdb>gdb</h2><p>GDB 是 GNU 开源组织发布的一个强大的 UNIX 下的程序调试工具，可以用来调试 C/C++ 开发的程序，PHP 和 Swoole 是使用 C 语言开发的，
所以可以用 GDB 来调试 PHP+Swoole 的程序。
gdb 调试是命令行交互式的，需要掌握常用的指令。</p><p><code>gdb -p 进程ID</code></p><h2 id=lsof>lsof</h2><p>可以查看某个进程打开的文件句柄。可以用于跟踪 swoole 的工作进程所有打开的 socket、file、资源。</p><p><code>lsof -i:9999</code></p><p><code>lsof -p [进程ID]</code></p><h2 id=pref>pref</h2><p>非常强大的动态跟踪工具，perf top 指令可用于实时分析正在执行程序的性能问题。
与 callgrind、xdebug、xhprof 等工具不同，perf 无需修改代码导出 profile 结果文件。</p><p><code>perf top -p [进程ID]</code></p><h2 id=awk>awk</h2><p>一个数据处理工具</p><p><code>awk '条件类型1'{动作1} 条件类型2{动作2}... filename</code></p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#998;font-style:italic># 变量名称</span>
<span style=color:#998;font-style:italic># $0 代表一整行数据</span>
<span style=color:#998;font-style:italic># $1-$n 代表第几列数据</span>
<span style=color:#998;font-style:italic># NF 每一行拥有的字段总数（$0）</span>
<span style=color:#998;font-style:italic># NR 目前 awk 处理的是 第几行 数据</span>
<span style=color:#998;font-style:italic># FS 目前的分隔符，默认是空格键</span>

<span style=color:#998;font-style:italic># 处理流程</span>
<span style=color:#998;font-style:italic># 1、读入第一行，并将第一行数据填入$0,$1,$2..$n变量中</span>
<span style=color:#998;font-style:italic># 2、依据条件类型的限制，判断是否要进行后面的动作</span>
<span style=color:#998;font-style:italic># 3、做完所有的动作与条件类型</span>
<span style=color:#998;font-style:italic># 4、若后面还有行数据，则重复1、2、3，直到所有的行读取完毕</span>

</code></pre></td></tr></table></div></div><p><code>cat /etc/passwd |awk 'BEGIN {FS=":"} $3 &lt; 10 {print $1 "\t" $3}'</code></p><h2 id=groups>groups</h2><p>查看有效与支持的用户组</p><h2 id=useradd>useradd</h2><p>新增用户</p><p><code>userass test_user</code></p><h2 id=passwd>passwd</h2><p>设置修改用户密码</p><p><code>passwd test_user</code></p><h2 id=su>su</h2><p>切换用户身份，需要输入切换用户的密码</p><p><code>su username</code> 切换成username用户，读取变量的设置方式为<code>non-login</code>shell的方式，这样方式下很多原本的环境变量不会被改变</p><p><code>su - username</code> 读取变量的设置方式为<code>login</code>shell的方式</p><p><code>su -c username "cmd"</code> 代表仅用此用户执行一次命令</p><h2 id=sudo>sudo</h2><p>切换用户，输入自己的密码，需要配置 <code>/ect/sudoers</code>，可用<code>visudo</code>命令编辑</p><p><code>sudo -u username pwd</code> 不加用户参数，默认root</p><h2 id=curl>curl</h2><p>基于网络协议，对指定URL进行网络传输
curl支持的通信协议有DICT, FILE, FTP, FTPS, GOPHER, HTTP, HTTPS, IMAP, IMAPS, LDAP, LDAPS, POP3, POP3S, RTMP, RTMPS, RTSP, SCP, SFTP, SMB, SBMS, SMTP, SMTPS, TELNET 和TFTP</p><p><code>curl --trace-time -v https://www.baidu.com</code> 可以调试请求时间和具体过程</p><h2 id=ssh>ssh</h2><p>SSH是一种网络协议，用于计算机之间的加密登录</p><p><code>ssh-keygen</code> 创建公钥</p><p><code>ssh-copy-id user@host</code> 复制本机公钥到服务器</p><p><code>ssh -p 2222 user@host</code> 登录服务器</p><h3 id=用来传输数据>用来传输数据</h3><p><code>cd && tar czv src | ssh user@host 'tar xz'</code> 将$HOME/src/目录下面的所有文件，复制到远程主机的$HOME/src/目录</p><p><code>ssh user@host 'tar cz src' | tar xzv</code> 将远程主机$HOME/src/目录下面的所有文件，复制到用户的当前目录</p><h3 id=绑定本地端口>绑定本地端口</h3><p>可以让那些不加密的网络连接，全部改走SSH连接，从而提高安全性</p><p><code>ssh -D 8080 user@host</code> 让8080端口的数据，都通过SSH传向远程主机</p><p>SSH会建立一个socket，去监听本地的8080端口。一旦有数据传向那个端口，就自动把它转移到SSH连接上面，发往远程主机。
可以想象，如果8080端口原来是一个不加密端口，现在将变成一个加密端口</p><h3 id=本地端口转发>本地端口转发</h3><p>有时，绑定本地端口还不够，还必须指定数据传送的目标主机，从而形成点对点的"端口转发&rdquo;。
为了区别后文的"远程端口转发&rdquo;，我们把这种情况称为"本地端口转发&rdquo;（Local forwarding）。</p><p>假定host1是本地主机，host2是远程主机。由于种种原因，这两台主机之间无法连通。但是，另外还有一台host3，可以同时连通前面两台主机。
因此，很自然的想法就是，通过host3，将host1连上host2</p><p><code>ssh -L 2121:host2:21 host3</code></p><p>命令中的L参数一共接受三个值，分别是"本地端口:目标主机:目标主机端口&rdquo;，它们之间用冒号分隔。
这条命令的意思，就是指定SSH绑定本地端口2121，然后指定host3将所有的数据，转发到目标主机host2的21端口（假定host2运行FTP，默认端口为21）
这样一来，我们只要连接host1的2121端口，就等于连上了host2的21端口</p><p>&ldquo;本地端口转发"使得host1和host3之间仿佛形成一个数据传输的秘密隧道，因此又被称为"SSH隧道&rdquo;</p><h3 id=远程端口转发>远程端口转发</h3><p>既然"本地端口转发"是指绑定本地端口的转发，那么"远程端口转发&rdquo;（remote forwarding）当然是指绑定远程端口的转发。</p><p>还是接着看上面那个例子，host1与host2之间无法连通，必须借助host3转发。但是，特殊情况出现了，host3是一台内网机器，它可以连接外网的host1，但是反过来就不行，外网的host1连不上内网的host3。这时，&ldquo;本地端口转发"就不能用了，怎么办？</p><p>解决办法是，既然host3可以连host1，那么就从host3上建立与host1的SSH连接，然后在host1上使用这条连接就可以了</p><p><code>ssh -R 2121:host2:21 host1</code></p><p>R参数也是接受三个值，分别是"远程主机端口:目标主机:目标主机端口&rdquo;。
这条命令的意思，就是让host1监听它自己的2121端口，然后将所有数据经由host3，转发到host2的21端口。由于对于host3来说，host1是远程主机，所以这种情况就被称为"远程端口绑定&rdquo;</p><p><code>ssh -NT -f -D 8080 host</code></p><p>N参数，表示只连接远程主机，不打开远程shell；T参数，表示不为这个连接分配TTY。这个两个参数可以放在一起用，代表这个SSH连接只用来传数据，不执行远程操作
f参数，表示SSH连接成功后，转入后台运行。这样一来，就可以在不中断SSH连接的情况下，在本地shell中执行其他操作</p><h2 id=netcat>netcat</h2><p>调试tcp udp</p><p><code>netcat -u ip port</code> 调试udp</p><h2 id=time>time</h2><p>显示命令执行时间</p><p><code>time command</code></p><p>参考链接：</p><p><a href=https://www.cnblogs.com/peida/category/309012.html>每天一个Linux命令</a></p><p><a href=https://wiki.swoole.com/#/other/tools>Swoole文档 工具使用</a></p><p><a href=http://www.ruanyifeng.com/blog/2011/12/ssh_port_forwarding.html>阮一峰 SSH原理与运用（二）：远程操作与端口转发</a></p></div><div class=post-archive><ul class=post-copyright><li><strong>原文作者：</strong><a rel=author href=https://blog.wenjy.top>江湖义气</a></li><li style=word-break:break-all><strong>原文链接：</strong><a href=https://blog.wenjy.top/2020/03/26/linux-command.html>https://blog.wenjy.top/2020/03/26/linux-command.html</a></li><li><strong>版权声明：</strong>本作品采用<a rel=license href=https://creativecommons.org/licenses/by-nc-nd/4.0/>知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议</a>进行许可，非商业转载请注明出处（作者，原文链接），商业转载请联系作者获得授权。</li></ul></div><br><div class=post-archive><h2>See Also</h2><ul class=listing><li><a href=/2020/03/26/git-command.html>Git 常用命令</a></li><li><a href=/2019/10/11/linux-lock-principle.html>Linux Lock的原理</a></li></ul></div><div class="post-meta meta-tags"><ul class=clearfix><li><a href=https://blog.wenjy.top/tags/Linux>Linux</a></li></ul></div></article><div class="post bg-white"><script src=https://utteranc.es/client.js repo=wenjy/blog issue-term=pathname theme=github-light crossorigin=anonymous async></script></div></div></div><div id=secondary><section class=widget><form id=search action=https://blog.wenjy.top/search/ method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=Search>
<input type=hidden name=sitesearch value=https://blog.wenjy.top>
<button type=submit class="submit icon-search"></button></form></section><section class=widget><h3 class=widget-title>最近文章</h3><ul class=widget-list><li><a href=https://blog.wenjy.top/2020/04/25/nat.html title=NAT原理>NAT原理</a></li><li><a href=https://blog.wenjy.top/2020/04/14/markdown.html title=Markdown语法>Markdown语法</a></li><li><a href=https://blog.wenjy.top/2020/04/14/tls.html title=TLS握手通信>TLS握手通信</a></li><li><a href=https://blog.wenjy.top/2020/04/14/regexp.html title=正则表达式>正则表达式</a></li><li><a href=https://blog.wenjy.top/2020/04/02/tcp-connect-close.html title="TCP 三次握手 四次挥手">TCP 三次握手 四次挥手</a></li><li><a href=https://blog.wenjy.top/2020/04/01/http-response-status-codes.html title="HTTP 响应状态码">HTTP 响应状态码</a></li><li><a href=https://blog.wenjy.top/2020/03/29/linux-file-permission.html title=Linux文件目录权限>Linux文件目录权限</a></li><li><a href=https://blog.wenjy.top/2020/03/26/git-command.html title="Git 常用命令">Git 常用命令</a></li><li><a href=https://blog.wenjy.top/2020/03/26/linux-command.html title="Linux 常用命令">Linux 常用命令</a></li><li><a href=https://blog.wenjy.top/2019/01/01/work-debug.html title=工作中遇到的问题+踩过的坑>工作中遇到的问题+踩过的坑</a></li></ul></section><section class=widget><h3 class=widget-title style=color:red>福利派送</h3><ul class=widget-list><li><a href target=_blank style=color:red></a></li></ul></section><section class=widget><h3 class=widget-title>分类</h3><ul class=widget-list><li><a href=https://blog.wenjy.top/categories/Algorithms/>Algorithms (9)</a></li><li><a href=https://blog.wenjy.top/categories/DesignPatten/>DesignPatten (25)</a></li><li><a href=https://blog.wenjy.top/categories/Git/>Git (1)</a></li><li><a href=https://blog.wenjy.top/categories/Http/>Http (1)</a></li><li><a href=https://blog.wenjy.top/categories/Linux/>Linux (3)</a></li><li><a href=https://blog.wenjy.top/categories/Markdown/>Markdown (1)</a></li><li><a href=https://blog.wenjy.top/categories/MySQL/>MySQL (1)</a></li><li><a href=https://blog.wenjy.top/categories/NAT/>NAT (1)</a></li><li><a href=https://blog.wenjy.top/categories/PHP/>PHP (38)</a></li><li><a href=https://blog.wenjy.top/categories/Regexp/>Regexp (1)</a></li><li><a href=https://blog.wenjy.top/categories/TCP/>TCP (1)</a></li><li><a href=https://blog.wenjy.top/categories/TLS/>TLS (1)</a></li></ul></section><section class=widget><h3 class=widget-title>标签</h3><div class=tagcloud><a href=https://blog.wenjy.top/tags/Algorithms/>Algorithms</a>
<a href=https://blog.wenjy.top/tags/DesignPatten/>DesignPatten</a>
<a href=https://blog.wenjy.top/tags/Git/>Git</a>
<a href=https://blog.wenjy.top/tags/Http/>Http</a>
<a href=https://blog.wenjy.top/tags/Linux/>Linux</a>
<a href=https://blog.wenjy.top/tags/Markdown/>Markdown</a>
<a href=https://blog.wenjy.top/tags/MySQL/>MySQL</a>
<a href=https://blog.wenjy.top/tags/NAT/>NAT</a>
<a href=https://blog.wenjy.top/tags/Network/>Network</a>
<a href=https://blog.wenjy.top/tags/PHP/>PHP</a>
<a href=https://blog.wenjy.top/tags/RSA/>RSA</a>
<a href=https://blog.wenjy.top/tags/Regexp/>Regexp</a>
<a href=https://blog.wenjy.top/tags/TCP/>TCP</a>
<a href=https://blog.wenjy.top/tags/TLS/>TLS</a></div></section><section class=widget><h3 class=widget-title>友情链接</h3><ul class=widget-list><li><a target=_blank href=https://mikelin.cn title="MIKELIN | 关注科技，弘扬互联网精神！">MIKELIN</a></li><li><a target=_blank href=https://blog.wenjy.top title=江湖义气的网络日志>江湖义气的网络日志</a></li></ul></section><section class=widget><h3 class=widget-title>其它</h3><ul class=widget-list><li><a href=https://blog.wenjy.top/index.xml>文章 RSS</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href=https://blog.wenjy.top>江湖义气的博客 By 江湖义气</a>.
Powered by <a rel="nofollow noreferer noopener" href=https://gohugo.io target=_blank>Hugo</a>.
<a href=https://www.flysnow.org/ target=_blank>Theme</a> based on <a href=https://github.com/flysnow-org/maupassant-hugo target=_blank>maupassant</a>.
备案号：<a href=http://www.beian.miit.gov.cn target=_blank>桂ICP备17000652号-2</a></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src="/js/totop.js?v=0.0.0" async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-161796130-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js async></script></body></html>